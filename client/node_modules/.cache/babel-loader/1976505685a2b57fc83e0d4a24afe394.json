{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/\\u043E\\u043B\\u0435\\u0433/Desktop/iTechArt_\\u0421\\u0442\\u0430\\u0436\\u0438\\u0440\\u043E\\u0432\\u043A\\u0430/songbird/songbird/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/\\u043E\\u043B\\u0435\\u0433/Desktop/iTechArt_\\u0421\\u0442\\u0430\\u0436\\u0438\\u0440\\u043E\\u0432\\u043A\\u0430/songbird/songbird/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React from\"react\";import{useDispatch,useSelector}from\"react-redux\";import lostSound from\"../../sounds/lost.mp3\";import wonSound from\"../../sounds/won.mp3\";import{selectIsLevelCompleted,selectScoreOnTheLevel}from\"../../redux/progress/selectors\";import{setIsCorrectCurrentBird,setSelectedBird}from\"../../redux/birds/actions\";import{setIsLevelCompleted,setScoreOnTheLevel,setTotalScore}from\"../../redux/progress/actions\";import{selectCurrentUser}from\"../../redux/user/selectors\";import{firestore}from\"../../firebase/utils\";import\"./styles.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AnswerOptions=function AnswerOptions(_ref){var birds=_ref.birds,currentBird=_ref.currentBird;var SOUND_VOLUME=0.1;var MAX_SCORE_ON_THE_LEVEL=5;var dispatch=useDispatch();var isLevelCompleted=useSelector(selectIsLevelCompleted);var scoreOnTheLevel=useSelector(selectScoreOnTheLevel);var currentUser=useSelector(selectCurrentUser);var writeUserData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(totalScore){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return firestore.doc(\"users/\".concat(currentUser.id)).set({createdAt:currentUser.createdAt,displayName:currentUser.displayName,email:currentUser.email,totalScore:totalScore});case 2:case\"end\":return _context.stop();}}},_callee);}));return function writeUserData(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"answer-options\",children:/*#__PURE__*/_jsx(\"ul\",{className:\"answers-group\",children:birds.map(function(bird){return/*#__PURE__*/_jsxs(\"li\",{className:\"answers-item\",onClick:function onClick(){if(currentUser){dispatch(setSelectedBird(bird));var click=document.querySelector(\"#\".concat(bird.name));if(!isLevelCompleted){if(bird.name===currentBird.name){click.classList.add(\"won\");var sound=new Audio(wonSound);sound.volume=SOUND_VOLUME;sound.play();dispatch(setIsCorrectCurrentBird(true));dispatch(setIsLevelCompleted(true));dispatch(setTotalScore(scoreOnTheLevel));currentUser.totalScore+=scoreOnTheLevel;writeUserData(currentUser.totalScore);dispatch(setScoreOnTheLevel(MAX_SCORE_ON_THE_LEVEL));}else{click.classList.remove(\"won\");if(!click.classList.contains(\"lost\")){var _sound=new Audio(lostSound);_sound.volume=SOUND_VOLUME;_sound.play();dispatch(setScoreOnTheLevel(scoreOnTheLevel-1));}click.classList.add(\"lost\");}}}},children:[/*#__PURE__*/_jsx(\"span\",{id:bird.name,className:\"circle\"}),bird.name]},bird.name);})})});};export default AnswerOptions;","map":{"version":3,"sources":["C:/Users/олег/Desktop/iTechArt_Стажировка/songbird/songbird/src/components/answerOptions/index.jsx"],"names":["React","useDispatch","useSelector","lostSound","wonSound","selectIsLevelCompleted","selectScoreOnTheLevel","setIsCorrectCurrentBird","setSelectedBird","setIsLevelCompleted","setScoreOnTheLevel","setTotalScore","selectCurrentUser","firestore","AnswerOptions","birds","currentBird","SOUND_VOLUME","MAX_SCORE_ON_THE_LEVEL","dispatch","isLevelCompleted","scoreOnTheLevel","currentUser","writeUserData","totalScore","doc","id","set","createdAt","displayName","email","map","bird","click","document","querySelector","name","classList","add","sound","Audio","volume","play","remove","contains"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nimport lostSound from \"../../sounds/lost.mp3\";\nimport wonSound from \"../../sounds/won.mp3\";\nimport {\n  selectIsLevelCompleted,\n  selectScoreOnTheLevel,\n} from \"../../redux/progress/selectors\";\nimport {\n  setIsCorrectCurrentBird,\n  setSelectedBird,\n} from \"../../redux/birds/actions\";\nimport {\n  setIsLevelCompleted,\n  setScoreOnTheLevel,\n  setTotalScore,\n} from \"../../redux/progress/actions\";\nimport { selectCurrentUser } from \"../../redux/user/selectors\";\nimport { firestore } from \"../../firebase/utils\";\n\nimport \"./styles.scss\";\n\nconst AnswerOptions = ({ birds, currentBird }) => {\n  const SOUND_VOLUME = 0.1;\n  const MAX_SCORE_ON_THE_LEVEL = 5;\n\n  const dispatch = useDispatch();\n  const isLevelCompleted = useSelector(selectIsLevelCompleted);\n  const scoreOnTheLevel = useSelector(selectScoreOnTheLevel);\n  const currentUser = useSelector(selectCurrentUser);\n\n  const writeUserData = async (totalScore) => {\n    await firestore.doc(`users/${currentUser.id}`).set({\n      createdAt: currentUser.createdAt,\n      displayName: currentUser.displayName,\n      email: currentUser.email,\n      totalScore: totalScore,\n    });\n  };\n\n  return (\n    <div className=\"answer-options\">\n      <ul className=\"answers-group\">\n        {birds.map((bird) => (\n          <li\n            key={bird.name}\n            className=\"answers-item\"\n            onClick={() => {\n              if (currentUser) {\n                dispatch(setSelectedBird(bird));\n                const click = document.querySelector(`#${bird.name}`);\n                if (!isLevelCompleted) {\n                  if (bird.name === currentBird.name) {\n                    click.classList.add(\"won\");\n                    const sound = new Audio(wonSound);\n                    sound.volume = SOUND_VOLUME;\n                    sound.play();\n                    dispatch(setIsCorrectCurrentBird(true));\n                    dispatch(setIsLevelCompleted(true));\n                    dispatch(setTotalScore(scoreOnTheLevel));\n                    currentUser.totalScore += scoreOnTheLevel;\n                    writeUserData(currentUser.totalScore);\n\n                    dispatch(setScoreOnTheLevel(MAX_SCORE_ON_THE_LEVEL));\n                  } else {\n                    click.classList.remove(\"won\");\n                    if (!click.classList.contains(\"lost\")) {\n                      const sound = new Audio(lostSound);\n                      sound.volume = SOUND_VOLUME;\n                      sound.play();\n                      dispatch(setScoreOnTheLevel(scoreOnTheLevel - 1));\n                    }\n                    click.classList.add(\"lost\");\n                  }\n                }\n              }\n            }}\n          >\n            <span id={bird.name} className={`circle`} />\n            {bird.name}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n\nexport default AnswerOptions;\n"]},"metadata":{},"sourceType":"module"}