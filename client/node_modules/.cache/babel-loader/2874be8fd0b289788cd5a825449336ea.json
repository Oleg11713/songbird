{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/\\u043E\\u043B\\u0435\\u0433/Desktop/iTechArt_\\u0421\\u0442\\u0430\\u0436\\u0438\\u0440\\u043E\\u0432\\u043A\\u0430/songbird/songbird/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"C:/Users/\\u043E\\u043B\\u0435\\u0433/Desktop/iTechArt_\\u0421\\u0442\\u0430\\u0436\\u0438\\u0440\\u043E\\u0432\\u043A\\u0430/songbird/songbird/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"C:/Users/\\u043E\\u043B\\u0435\\u0433/Desktop/iTechArt_\\u0421\\u0442\\u0430\\u0436\\u0438\\u0440\\u043E\\u0432\\u043A\\u0430/songbird/songbird/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/\\u043E\\u043B\\u0435\\u0433/Desktop/iTechArt_\\u0421\\u0442\\u0430\\u0436\\u0438\\u0440\\u043E\\u0432\\u043A\\u0430/songbird/songbird/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{Redirect,Route}from\"react-router-dom\";import{useDispatch,useSelector}from\"react-redux\";import Header from\"./components/header\";import Homepage from\"./pages/homepage\";import EndGamePage from\"./pages/endGamePage\";import SignInAndSignUpPage from\"./pages/signInAndSignUp\";import{selectCurrentUser}from\"./redux/user/selectors\";import{setCurrentUser}from\"./redux/user/actions\";import{auth,createUserProfileDocument}from\"./firebase/utils\";import ProfilePage from\"./pages/userProfile\";import\"./App.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var currentUser=useSelector(selectCurrentUser);var dispatch=useDispatch();useEffect(function(){setLoading(true);var result=auth.onAuthStateChanged(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(userAuth){var userRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!userAuth){_context.next=5;break;}_context.next=3;return createUserProfileDocument(userAuth);case 3:userRef=_context.sent;if(loading)userRef.onSnapshot(function(snapShot){dispatch(setCurrentUser(_objectSpread({id:snapShot.id},snapShot.data())));});case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());result();return setLoading(false);},[dispatch,loading]);return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",component:Homepage}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/endGame\",component:EndGamePage}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/profile\",component:ProfilePage}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/signIn\",render:function render(){return currentUser?/*#__PURE__*/_jsx(Redirect,{to:\"/\"}):/*#__PURE__*/_jsx(SignInAndSignUpPage,{});}})]});};export default App;","map":{"version":3,"sources":["C:/Users/олег/Desktop/iTechArt_Стажировка/songbird/songbird/src/App.js"],"names":["React","useEffect","useState","Redirect","Route","useDispatch","useSelector","Header","Homepage","EndGamePage","SignInAndSignUpPage","selectCurrentUser","setCurrentUser","auth","createUserProfileDocument","ProfilePage","App","loading","setLoading","currentUser","dispatch","result","onAuthStateChanged","userAuth","userRef","onSnapshot","snapShot","id","data"],"mappings":"40BAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,QAAT,CAAmBC,KAAnB,KAAgC,kBAAhC,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CAEA,MAAOC,CAAAA,MAAP,KAAmB,qBAAnB,CACA,MAAOC,CAAAA,QAAP,KAAqB,kBAArB,CACA,MAAOC,CAAAA,WAAP,KAAwB,qBAAxB,CACA,MAAOC,CAAAA,mBAAP,KAAgC,yBAAhC,CACA,OAASC,iBAAT,KAAkC,wBAAlC,CACA,OAASC,cAAT,KAA+B,sBAA/B,CACA,OAASC,IAAT,CAAeC,yBAAf,KAAgD,kBAAhD,CACA,MAAOC,CAAAA,WAAP,KAAwB,qBAAxB,CAEA,MAAO,WAAP,C,wFAEA,GAAMC,CAAAA,GAAG,CAAG,QAANA,CAAAA,GAAM,EAAM,CAChB,cAA8Bd,QAAQ,CAAC,IAAD,CAAtC,wCAAOe,OAAP,eAAgBC,UAAhB,eACA,GAAMC,CAAAA,WAAW,CAAGb,WAAW,CAACK,iBAAD,CAA/B,CACA,GAAMS,CAAAA,QAAQ,CAAGf,WAAW,EAA5B,CAEAJ,SAAS,CAAC,UAAM,CACdiB,UAAU,CAAC,IAAD,CAAV,CACA,GAAMG,CAAAA,MAAM,CAAGR,IAAI,CAACS,kBAAL,0FAAwB,iBAAOC,QAAP,kIACjCA,QADiC,+CAEbT,CAAAA,yBAAyB,CAACS,QAAD,CAFZ,QAE7BC,OAF6B,eAInC,GAAIP,OAAJ,CACEO,OAAO,CAACC,UAAR,CAAmB,SAACC,QAAD,CAAc,CAC/BN,QAAQ,CACNR,cAAc,gBACZe,EAAE,CAAED,QAAQ,CAACC,EADD,EAETD,QAAQ,CAACE,IAAT,EAFS,EADR,CAAR,CAMD,CAPD,EALiC,sDAAxB,+DAAf,CAeAP,MAAM,GACN,MAAOH,CAAAA,UAAU,CAAC,KAAD,CAAjB,CACD,CAnBQ,CAmBN,CAACE,QAAD,CAAWH,OAAX,CAnBM,CAAT,CAqBA,mBACE,aAAK,SAAS,CAAC,WAAf,wBACE,KAAC,MAAD,IADF,cAEE,KAAC,KAAD,EAAO,KAAK,KAAZ,CAAa,IAAI,CAAC,GAAlB,CAAsB,SAAS,CAAET,QAAjC,EAFF,cAGE,KAAC,KAAD,EAAO,KAAK,KAAZ,CAAa,IAAI,CAAC,UAAlB,CAA6B,SAAS,CAAEC,WAAxC,EAHF,cAIE,KAAC,KAAD,EAAO,KAAK,KAAZ,CAAa,IAAI,CAAC,UAAlB,CAA6B,SAAS,CAAEM,WAAxC,EAJF,cAKE,KAAC,KAAD,EACE,KAAK,KADP,CAEE,IAAI,CAAC,SAFP,CAGE,MAAM,CAAE,wBACNI,CAAAA,WAAW,cAAG,KAAC,QAAD,EAAU,EAAE,CAAC,GAAb,EAAH,cAAyB,KAAC,mBAAD,IAD9B,EAHV,EALF,GADF,CAeD,CAzCD,CA2CA,cAAeH,CAAAA,GAAf","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Redirect, Route } from \"react-router-dom\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nimport Header from \"./components/header\";\nimport Homepage from \"./pages/homepage\";\nimport EndGamePage from \"./pages/endGamePage\";\nimport SignInAndSignUpPage from \"./pages/signInAndSignUp\";\nimport { selectCurrentUser } from \"./redux/user/selectors\";\nimport { setCurrentUser } from \"./redux/user/actions\";\nimport { auth, createUserProfileDocument } from \"./firebase/utils\";\nimport ProfilePage from \"./pages/userProfile\";\n\nimport \"./App.css\";\n\nconst App = () => {\n  const [loading, setLoading] = useState(true);\n  const currentUser = useSelector(selectCurrentUser);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    setLoading(true);\n    const result = auth.onAuthStateChanged(async (userAuth) => {\n      if (userAuth) {\n        const userRef = await createUserProfileDocument(userAuth);\n\n        if (loading)\n          userRef.onSnapshot((snapShot) => {\n            dispatch(\n              setCurrentUser({\n                id: snapShot.id,\n                ...snapShot.data(),\n              })\n            );\n          });\n      }\n    });\n    result();\n    return setLoading(false);\n  }, [dispatch, loading]);\n\n  return (\n    <div className=\"container\">\n      <Header />\n      <Route exact path=\"/\" component={Homepage} />\n      <Route exact path=\"/endGame\" component={EndGamePage} />\n      <Route exact path=\"/profile\" component={ProfilePage} />\n      <Route\n        exact\n        path=\"/signIn\"\n        render={() =>\n          currentUser ? <Redirect to=\"/\" /> : <SignInAndSignUpPage />\n        }\n      />\n    </div>\n  );\n};\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}